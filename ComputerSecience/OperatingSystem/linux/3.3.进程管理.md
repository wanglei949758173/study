# 进程管理

## 基本介绍

1. 在linux中，**每个执行的程序都称为一个进程**。每一个进程都分配一个Id号，称之为pid。
2. **每一个进程，都会有一个父进程**，而这个父进程可以复制多个子进程。例如www服务器。
3. **每个进程都能以两种方式存在，前台或后台**，所谓前台进程就是用户目前的屏幕上可以进行操作的。后台进程则是实际在操作，但是当前屏幕上无法看到。启动服务通常以后台方式执行。
4. 一般系统的服务都是以后台进程的方式存在，而且都会常驻在系统中。直到关机才结束。

## 显示系统执行的进程

### 基本介绍

查看进程使用的指令是`ps`，一般来说使用的参数是`ps -aux`

- -a：显示当前终端的所有进程信息
- -u：以用户的格式显示进程信息
- -x：显示后台进程运行的参数

`ps -aux | grep xxx`，比如可以看看有没有sshd服务

![image-20201117214956452](3.3.进程管理.assets/image-20201117214956452.png)

### ps指令详解

* `ps -aux`

  System V展示风格：

  | 列      | 含义                         |
  | ------- | ---------------------------- |
  | USER    | 用户名                       |
  | PID     | 进程Id                       |
  | %CPU    | 占用的CPU                    |
  | %MEM    | 占用的内存                   |
  | VSZ     | 使用的虚拟内存               |
  | RSS     | 使用的物理内存               |
  | TTY     | 使用的终端                   |
  | STAT    | 进程的状态，s：休眠，r：运行 |
  | START   | 启动时间                     |
  | TIME    | 占用CPU的总时间              |
  | COMMAND | 进程执行时候的命令行         |

* `ps -ef`：以全格式显示当前所有的进程

  -e：显示所有进程

  -f：全格式

  BSD风格

  | 列    | 含义                                                         |
  | ----- | ------------------------------------------------------------ |
  | UID   | 用户Id                                                       |
  | PID   | 进程ID                                                       |
  | PPID  | 父进程ID                                                     |
  | C     | CPU用于计算执行优先级的因子。数值越大，表明进程是CPU密集型运算，执行优先级会降低；数值越小，表示进程是I/O密集型运算，执行优先级会提高 |
  | STIME | 进程启动的时间                                               |
  | TTY   | 完整的终端名称                                               |
  | TIME  | CPU时间                                                      |
  | CMD   | 启动进程所用的命令和参数                                     |

## 终止进程

### 基本语法

- kill [选项] 进程号 (功能描述：通过进程号杀死进程)
- killall 进程名称 (功能描述：通过进程名杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用)

### 常用选项

- -9：表示强迫进程立即停止

### 最佳实践

1. **案例一：踢掉某个非法登录用户**

   * 查看sshd进程

     ![image-20201118220342047](3.3.进程管理.assets/image-20201118220342047.png)

   * 终止进程

     `kill 6121`

2. **案例2：终止远程登录服务sshd，在适当时候再次重启sshd服务**

   * 查找sshd进程

     ![image-20201118220718299](3.3.进程管理.assets/image-20201118220718299.png)

   * 终止进程

     `kill 1188`

3. **案例3：终止多个gedit编辑器【killall：通过进程名来终止进程】**

   `killall gedit`

4. **案例4：强制杀掉一个终端**

## 查看进程树

### 基本语法

- pstree [选项]，可以更加直观的来看进程信息

### 常用选项

- -p：显示进程的PID
- -u：显示进程的所属用户

### 应用实例

* **案例1：请以树状的形式显示进程的pid**

  `pstree -p`

## 服务管理

### 基本介绍

​	服务(service)本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其他程序的请求。

​	比如（mysql，sshd防火墙等），因此我们又称为守护进程。

### 服务的管理指令

